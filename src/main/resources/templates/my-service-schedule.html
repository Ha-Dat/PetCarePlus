<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Hồ sơ của tôi</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{css/header.css}">
    <link rel="stylesheet" th:href="@{css/footer.css}">
    <style>
        /* ========================
           PROFILE BODY
        ======================== */
        .sidebar {
            width: 220px;
            background-color: #ffffff;
            border-right: 1px solid #ddd;
            padding: 30px 20px;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar a {
            color: #333;
            font-weight: 500;
            text-decoration: none;
            display: block;
            padding: 10px 0;
            transition: color 0.3s;
        }

        .sidebar a:hover,
        .sidebar a.active {
            color: #4caf50;
        }

        .main-content {
            flex: 1;
            padding: 40px;
            background-color: #f8f9fa;
        }

        .form-section {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.03);
            display: flex;
            align-items: center;
        }

        .avatar-preview {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #4caf50;
        }

        .form-label {
            font-weight: bold;
            margin-bottom: 6px;
        }

        input:focus,
        select:focus {
            border-color: #4caf50;
            outline: none;
        }

        .btn-custom {
            background-color: #4caf50;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            border: none;
            font-weight: bold;
            transition: background-color 0.3s;
            margin-right: 10px;
        }

        .btn-custom:hover {
            background-color: #388e3c;
        }
    </style>
</head>
<body>
<div th:insert="component/header :: header"></div>
<div class="d-flex">
    <!-- Sidebar -->
    <div class="sidebar">
        <ul>
            <li><a href="/customer/profile">Hồ Sơ</a></li>
            <li><a href="/customer/address">Địa chỉ</a></li>
            <li><a href="/customer/change-password">Đổi mật khẩu</a></li>
            <li><a href="/customer/pet-profile">Hồ Sơ thú cưng</a></li>
            <li><a href="/customer/list_order">Đơn mua</a></li>
            <li><a href="/customer/my-schedule" class="active">Lịch</a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h4>Lịch đặt dịch vụ</h4>
        <hr>

        <!-- Tabs dịch vụ -->
        <div class="tabs">
            <a th:href="@{/customer/my-schedule(type='all')}"
               th:classappend="${selectedType}=='Tất cả' ? 'active' : ''">Tất cả</a>
            <a th:href="@{/customer/my-schedule(type='Spa')}"
               th:classappend="${selectedType}=='Spa' ? 'active' : ''">Spa</a>
            <a th:href="@{/customer/my-schedule(type='Khám bệnh')}"
               th:classappend="${selectedType}=='Khám bệnh' ? 'active' : ''">Khám bệnh</a>
            <a th:href="@{/customer/my-schedule(type='Khách sạn thú cưng')}"
               th:classappend="${selectedType}=='Khách sạn thú cưng' ? 'active' : ''">Khách sạn thú cưng</a>
        </div>

        <!-- Tabs trạng thái -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link"
                   th:href="@{'/customer/my-schedule'(type=${selectedType}, status='Chờ duyệt')}"
                   th:classappend="${selectedStatus}=='Chờ duyệt' ? 'active' : ''">Chờ duyệt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                   th:href="@{'/customer/my-schedule'(type=${selectedType}, status='Đã duyệt')}"
                   th:classappend="${selectedStatus}=='Đã duyệt' ? 'active' : ''">Đã duyệt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                   th:href="@{'/customer/my-schedule'(type=${selectedType}, status='Từ chối')}"
                   th:classappend="${selectedStatus}=='Từ chối' ? 'active' : ''">Từ chối</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                   th:href="@{'/customer/my-schedule'(type=${selectedType}, status='Hủy')}"
                   th:classappend="${selectedStatus}=='Hủy' ? 'active' : ''">Hủy</a>
            </li>
        </ul>

        <!-- Bảng lịch -->
        <table class="table table-bordered bg-white">
            <thead class="table-light">
            <tr>
                <th>Thú cưng</th>
                <th>Dịch vụ</th>
                <th>Thời gian</th>
                <th>Trạng thái</th>
                <th>Hành động</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="s : ${schedules}">
                <td th:text="${s.petName}"></td>
                <td th:text="${s.serviceCategory.value}"></td>
                <td th:text="${#temporals.format(s.bookDate, 'dd/MM/yyyy')}"></td>
                <td th:text="${s.status.value}"></td>
                <td>
                    <span th:if="${s.status.value == 'Chờ duyệt'}">
                        <a th:href="@{'/customer/my-schedule/cancel'(id=${s.bookingId}, category=${s.serviceCategory.value}, type=${selectedType}, status=${selectedStatus})}"
                           class="text-danger"
                           onclick="return confirm('Bạn có chắc chắn muốn hủy lịch này?');">
                            <i class="fas fa-times-circle"></i> Hủy
                        </a>
                    </span>
                    <span th:if="${s.status.value != 'Chờ duyệt'}">—</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div th:insert="component/footer :: footer"></div>
</body>
<script th:src="@{js/header.js}"></script>
</html>
